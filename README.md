# Problematic Internet Use Prediction ‚Äî LLM-Enhanced

## Description

This repository contains a hybrid solution for the [Child Mind Institute - Problematic Internet Use](https://www.kaggle.com/competitions/child-mind-institute-problematic-internet-use) Kaggle competition. The objective is to predict the severity of problematic internet use (PIU) in children and adolescents, combining:

- Structured questionnaire and biometric data,
- Time series from wearable sensors, and
- Textual embeddings generated by a lightweight LLM (`SentenceTransformer`).

The pipeline includes preprocessing, feature engineering, embedding generation, model training using LightGBM, and prediction formatting for submission.

---

## Folder Structure

- `main.py`: Main pipeline ‚Äî data loading, feature engineering, embedding creation, model training, and prediction generation.  
- `requirements.txt`: List of required packages.  
- `train.csv`, `test.csv`, `sample_submission.csv`: Static structured data (See [Usage](#usage) section) 
- `series_train.parquet`, `series_test.parquet`: Time series sensor data (See [Usage](#usage) section) 
- `submission.csv`: Output file formatted for submission to Kaggle.  

---

## Installation

You will need Python 3.7+ and the required packages:

```bash
pip install -r requirements.txt
```

**requirements.txt**
```
numpy  
pandas  
matplotlib  
tqdm  
scipy  
scikit-learn  
lightgbm  
optuna  
pyarrow  
sentence-transformers
```

---

## Usage

1. **Place the competition data** in the project directory.

   If you have the Kaggle API configured, run:
     ```
     kaggle competitions download -c child-mind-institute-problematic-internet-use
     ```

   OR you can download the data by clicking the folder above.

   [<span style="font-size:2em;">üìÅ</span>](https://www.kaggle.com/competitions/child-mind-institute-problematic-internet-use/data)

   At the bottom of the page you will find the download links for all files.
2. **Run the pipeline**:

   ```bash
   python main.py
   ```

3. **Output**:  
   A `submission.csv` file will be generated containing predictions in the required format.

---

## System Overview

- **Data Fusion**: Structured data and sensor time series are loaded and merged by `id`.
- **Feature Engineering**:  
  - Time-series are summarized via statistical descriptors (e.g., mean, std, activity streaks).  
  - Derived variables are created (e.g., BMI ratios, age brackets, hydration status).
- **LLM Integration**:  
  - Psychometric responses (e.g., PCIAT, FGC, SDS) are transformed into natural-language-like text.  
  - `SentenceTransformer` converts this text into 384-dimensional semantic embeddings.  
  - These embeddings are appended as numeric features for model input.
- **Modeling**:  
  - LightGBM is trained using stratified cross-validation with 5 folds.  
  - Thresholds for ordinal prediction (`sii`) are optimized using QWK loss.
- **Augmentation**:  
  - Gaussian noise and simulated missing data are introduced for robustness.

---

## Submission Format

The output `submission.csv` contains:

```
id,sii  
00008ff9,3  
000fd460,0  
...
```

Where `sii` is the predicted class from 0 to 3.

---

## Notes on LLM Usage

- The model `all-MiniLM-L6-v2` is used to embed user responses in a semantically meaningful vector space.
- This allows capturing abstract relationships between symptoms (e.g., impulsivity, withdrawal) beyond traditional numeric transformations.
- It provides richer input for models, improving generalization without requiring deep neural networks.

---

## Contributors

- **Jan‚ÄØHenrik‚ÄØS√°nchez‚ÄØJerez** ‚Äì‚ÄØ20231020130  
- **Juan‚ÄØDavid‚ÄØQuiroga** ‚Äì‚ÄØ20222020206 

---

## References

- [Competition Overview](https://www.kaggle.com/competitions/child-mind-institute-problematic-internet-use/overview)  
- [3rd Place Solution (Jobayer Hossain)](https://www.kaggle.com/code/jobayerhossain/child-mind-piu-3rd-place-solution/notebook)  
